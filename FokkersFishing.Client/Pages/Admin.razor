@page "/admin"
@using Microsoft.AspNetCore.Authorization
@using Microsoft.AspNetCore.Components.WebAssembly.Authentication
@inject IHttpClientFactory ClientFactory

<h1>Fokkers Users</h1>
<div class="main">
    @if (users == null)
    {
        <p><em>Loading Users...</em></p>
        <MatProgressBar Indeterminate="true"></MatProgressBar>
    }
    else
    {

        <h3>Users</h3>
        <MatTable Items="@users" class="mat-elevation-z5" Striped="true"
                  RowClass="tester"
                  SortBy="Length"
                  PageSize="10"
                  FilterByColumnName="UserName"
                  ShowPaging="false">
            <MatTableHeader>
                <th width="25%">User Name</th>
                <th width="25%">E-Mail</th>
                <th width="25%">Roles</th>
            </MatTableHeader>
            <MatTableRow>
                <td>@context.UserName</td>
                <td>@context.Email</td>
                <td>@context.RoleList</td>
            </MatTableRow>
        </MatTable>
    }
</div>

@code {
    List<User> users;

    protected async override Task OnInitializedAsync()
    {
        var client = ClientFactory.CreateClient("server");
        users = await client.GetFromJsonAsync<List<User>>("/users");
    }
}


